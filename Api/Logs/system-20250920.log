2025-09-20 14:28:28.766 -05:00 [INF] Executed DbCommand (112ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE DATABASE `Api_Mediconnet_Onion`;
2025-09-20 14:28:31.111 -05:00 [INF] Executed DbCommand (116ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER DATABASE CHARACTER SET utf8mb4;
2025-09-20 14:28:31.254 -05:00 [INF] Executed DbCommand (139ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TArea` (
    `NAreaID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    `CDescripcion` varchar(1000) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NAreaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:31.375 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TDiaSemana` (
    `NDiaSemanaID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NDiaSemanaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:31.492 -05:00 [INF] Executed DbCommand (114ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEspecialidad` (
    `NEspecialidadID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    `CDescripcion` varchar(100) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEspecialidadID`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:31.612 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEstadoCita` (
    `NEstadoCitaID` int(6) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEstadoCitaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:31.749 -05:00 [INF] Executed DbCommand (134ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEstadoUsuario` (
    `NEstadoUsuarioID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(20) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEstadoUsuarioID`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:31.874 -05:00 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEstadoVerificacion` (
    `NEstadoVerificacion` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEstadoVerificacion`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:32.009 -05:00 [INF] Executed DbCommand (132ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TGrupoSanguineo` (
    `NGrupoSanguineoID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(10) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NGrupoSanguineoID`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:32.132 -05:00 [INF] Executed DbCommand (119ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TRol` (
    `NRolID` int(32) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(20) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NRolID`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:32.247 -05:00 [INF] Executed DbCommand (112ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TTipoIdentificacion` (
    `NTipoIdentificacion` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NTipoIdentificacion`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:32.375 -05:00 [INF] Executed DbCommand (125ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TUsuario` (
    `nUsuarioID` int(32) NOT NULL AUTO_INCREMENT,
    `NEstadoVerificacionFK` int(12) NOT NULL,
    `NEstadoUsuarioFK` int(12) NOT NULL,
    `NRolFK` int(12) NOT NULL,
    `CNombre` varchar(50) CHARACTER SET utf8mb4 NOT NULL,
    `CApellido` varchar(100) CHARACTER SET utf8mb4 NOT NULL,
    `CEmail` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `CPassword` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaRegistro` DateTime NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`nUsuarioID`),
    CONSTRAINT `FK_Usuario_EstadoUsuario` FOREIGN KEY (`NEstadoUsuarioFK`) REFERENCES `TEstadoUsuario` (`NEstadoUsuarioID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_Usuario_EstadoVerificacion` FOREIGN KEY (`NEstadoVerificacionFK`) REFERENCES `TEstadoVerificacion` (`NEstadoVerificacion`) ON DELETE RESTRICT,
    CONSTRAINT `FK_Usuario_Rol` FOREIGN KEY (`NRolFK`) REFERENCES `TRol` (`NRolID`) ON DELETE RESTRICT
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:32.515 -05:00 [INF] Executed DbCommand (136ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TCodigoVerificacion` (
    `NCodigoVerificacionID` int(32) NOT NULL AUTO_INCREMENT,
    `NUsuarioFK` int(6) NOT NULL,
    `CCodigo` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `ETipoCodigo` varchar(25) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaExpiracion` datetime NOT NULL,
    `BUsado` tinyint(1) NOT NULL DEFAULT FALSE,
    `NIntentos` int(11) NOT NULL,
    `DFechaCreacion` datetime NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NCodigoVerificacionID`),
    CONSTRAINT `FK_CodigoVerificacion_Usuario` FOREIGN KEY (`NUsuarioFK`) REFERENCES `TUsuario` (`nUsuarioID`) ON DELETE RESTRICT
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:32.770 -05:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TLogins` (
    `NLoginID` int(32) NOT NULL AUTO_INCREMENT,
    `DFechaLogin` DateTime NOT NULL,
    `NUsuarioFK` int(32) NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NLoginID`),
    CONSTRAINT `FK_Usuario_Logins` FOREIGN KEY (`NUsuarioFK`) REFERENCES `TUsuario` (`nUsuarioID`) ON DELETE RESTRICT
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:32.902 -05:00 [INF] Executed DbCommand (129ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TPersona` (
    `NPersonaID` int(32) NOT NULL AUTO_INCREMENT,
    `NUsuarioFK` int(32) NOT NULL,
    `NTipoIdentificacionFK` int(32) NOT NULL,
    `CNroIdentificacion` varchar(20) CHARACTER SET utf8mb4 NOT NULL,
    `CNroConctacto` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    `CDireccion` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaNacimiento` DateTime NOT NULL,
    `ESexo` varchar(25) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NPersonaID`),
    CONSTRAINT `FK_Personas_TipoIdentificacion` FOREIGN KEY (`NTipoIdentificacionFK`) REFERENCES `TTipoIdentificacion` (`NTipoIdentificacion`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TPersona_TUsuario_NUsuarioFK` FOREIGN KEY (`NUsuarioFK`) REFERENCES `TUsuario` (`nUsuarioID`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:33.043 -05:00 [INF] Executed DbCommand (137ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TPaciente` (
    `NPacienteID` int(32) NOT NULL AUTO_INCREMENT,
    `NPersonaFK` int(32) NOT NULL,
    `NGrupoSanguineoFK` int(6) NOT NULL,
    `CAlergiasGenerales` varchar(2000) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NPacienteID`),
    CONSTRAINT `FK_Paciente_GrupoSanguineo` FOREIGN KEY (`NGrupoSanguineoFK`) REFERENCES `TGrupoSanguineo` (`NGrupoSanguineoID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TPaciente_TPersona_NPersonaFK` FOREIGN KEY (`NPersonaFK`) REFERENCES `TPersona` (`NPersonaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:33.180 -05:00 [INF] Executed DbCommand (133ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TProfesional` (
    `NProfesionalID` int(32) NOT NULL AUTO_INCREMENT,
    `NPersonaFK` int(32) NOT NULL,
    `NEspecialidadFK` int(12) NOT NULL,
    `NAreaFK` int(12) NOT NULL,
    `CRegistroProfesional` varchar(50) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaContratacion` DateTime NOT NULL,
    `ETipoProfesional` varchar(25) CHARACTER SET utf8mb4 NOT NULL,
    `CBiografia` varchar(2000) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NProfesionalID`),
    CONSTRAINT `FK_Profesional_Area` FOREIGN KEY (`NAreaFK`) REFERENCES `TArea` (`NAreaID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_Profesional_Especialidad` FOREIGN KEY (`NEspecialidadFK`) REFERENCES `TEspecialidad` (`NEspecialidadID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TProfesional_TPersona_NPersonaFK` FOREIGN KEY (`NPersonaFK`) REFERENCES `TPersona` (`NPersonaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:33.318 -05:00 [INF] Executed DbCommand (133ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TCita` (
    `NCitaID` int(12) NOT NULL AUTO_INCREMENT,
    `NEstadoCitaFK` int(12) NOT NULL,
    `NProfesionalFK` int(12) NOT NULL,
    `NPacienteFK` int(12) NOT NULL,
    `NDiaSemanaFK` int(12) NOT NULL,
    `DFecha` datetime NOT NULL,
    `DHora` time NOT NULL,
    `DDuracion` time NOT NULL,
    `CObservacion` varchar(500) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaRegistro` datetime NOT NULL,
    `ProfesionalNProfesionalID` int(32) NOT NULL,
    `PacienteNPacienteID` int(32) NOT NULL,
    `EstadoNEstadoCitaID` int(6) NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NCitaID`),
    CONSTRAINT `FK_Cita_DiaSemana` FOREIGN KEY (`NDiaSemanaFK`) REFERENCES `TDiaSemana` (`NDiaSemanaID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TCita_TEstadoCita_EstadoNEstadoCitaID` FOREIGN KEY (`EstadoNEstadoCitaID`) REFERENCES `TEstadoCita` (`NEstadoCitaID`) ON DELETE CASCADE,
    CONSTRAINT `FK_TCita_TPaciente_PacienteNPacienteID` FOREIGN KEY (`PacienteNPacienteID`) REFERENCES `TPaciente` (`NPacienteID`) ON DELETE CASCADE,
    CONSTRAINT `FK_TCita_TProfesional_ProfesionalNProfesionalID` FOREIGN KEY (`ProfesionalNProfesionalID`) REFERENCES `TProfesional` (`NProfesionalID`) ON DELETE CASCADE
) CHARACTER SET=utf8mb4;
2025-09-20 14:28:33.440 -05:00 [INF] Executed DbCommand (118ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TDiaSemana` (`NDiaSemanaID`, `CNombre`)
VALUES (1, 'Lunes'),
(2, 'Martes'),
(3, 'Miércoles'),
(4, 'Jueves'),
(5, 'Viernes'),
(6, 'Sábado'),
(7, 'Domingo');
2025-09-20 14:28:33.560 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TEstadoUsuario` (`NEstadoUsuarioID`, `CNombre`)
VALUES (1, 'Activo'),
(2, 'Inactivo');
2025-09-20 14:28:33.671 -05:00 [INF] Executed DbCommand (108ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TEstadoVerificacion` (`NEstadoVerificacion`, `CNombre`)
VALUES (1, 'No Verificado'),
(2, 'Verificado');
2025-09-20 14:28:33.787 -05:00 [INF] Executed DbCommand (113ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TGrupoSanguineo` (`NGrupoSanguineoID`, `CNombre`)
VALUES (1, 'A+'),
(2, 'A-'),
(3, 'B+'),
(4, 'B-'),
(5, 'AB+'),
(6, 'AB-'),
(7, 'O+'),
(8, 'O-');
2025-09-20 14:28:33.908 -05:00 [INF] Executed DbCommand (116ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TRol` (`NRolID`, `CNombre`)
VALUES (1, 'Administrador'),
(2, 'Paciente'),
(3, 'Medico');
2025-09-20 14:28:34.022 -05:00 [INF] Executed DbCommand (110ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TTipoIdentificacion` (`NTipoIdentificacion`, `CNombre`)
VALUES (1, 'Cédula de ciudadanía'),
(2, 'Tarjeta de identidad'),
(3, 'Registro civil de nacimiento'),
(4, 'Cédula de extranjería'),
(5, 'Pasaporte');
2025-09-20 14:28:34.164 -05:00 [INF] Executed DbCommand (139ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre` ON `TArea` (`CNombre`);
2025-09-20 14:28:34.296 -05:00 [INF] Executed DbCommand (130ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_EstadoNEstadoCitaID` ON `TCita` (`EstadoNEstadoCitaID`);
2025-09-20 14:28:34.419 -05:00 [INF] Executed DbCommand (119ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_NDiaSemanaFK` ON `TCita` (`NDiaSemanaFK`);
2025-09-20 14:28:34.543 -05:00 [INF] Executed DbCommand (120ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_PacienteNPacienteID` ON `TCita` (`PacienteNPacienteID`);
2025-09-20 14:28:34.663 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_ProfesionalNProfesionalID` ON `TCita` (`ProfesionalNProfesionalID`);
2025-09-20 14:28:34.786 -05:00 [INF] Executed DbCommand (120ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CCodigo` ON `TCodigoVerificacion` (`CCodigo`);
2025-09-20 14:28:34.910 -05:00 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCodigoVerificacion_NUsuarioFK` ON `TCodigoVerificacion` (`NUsuarioFK`);
2025-09-20 14:28:35.046 -05:00 [INF] Executed DbCommand (131ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre1` ON `TDiaSemana` (`CNombre`);
2025-09-20 14:28:35.178 -05:00 [INF] Executed DbCommand (130ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre2` ON `TEspecialidad` (`CNombre`);
2025-09-20 14:28:35.299 -05:00 [INF] Executed DbCommand (118ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre3` ON `TEstadoCita` (`CNombre`);
2025-09-20 14:28:35.422 -05:00 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre4` ON `TEstadoUsuario` (`CNombre`);
2025-09-20 14:28:35.551 -05:00 [INF] Executed DbCommand (127ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre5` ON `TEstadoVerificacion` (`CNombre`);
2025-09-20 14:28:35.684 -05:00 [INF] Executed DbCommand (130ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre6` ON `TGrupoSanguineo` (`CNombre`);
2025-09-20 14:28:35.815 -05:00 [INF] Executed DbCommand (129ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TLogins_NUsuarioFK` ON `TLogins` (`NUsuarioFK`);
2025-09-20 14:28:35.947 -05:00 [INF] Executed DbCommand (129ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TPaciente_NGrupoSanguineoFK` ON `TPaciente` (`NGrupoSanguineoFK`);
2025-09-20 14:28:36.070 -05:00 [INF] Executed DbCommand (120ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_TPaciente_NPersonaFK` ON `TPaciente` (`NPersonaFK`);
2025-09-20 14:28:36.209 -05:00 [INF] Executed DbCommand (136ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNroIdentificacion` ON `TPersona` (`CNroIdentificacion`);
2025-09-20 14:28:36.345 -05:00 [INF] Executed DbCommand (133ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TPersona_NTipoIdentificacionFK` ON `TPersona` (`NTipoIdentificacionFK`);
2025-09-20 14:28:36.482 -05:00 [INF] Executed DbCommand (136ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_TPersona_NUsuarioFK` ON `TPersona` (`NUsuarioFK`);
2025-09-20 14:28:36.607 -05:00 [INF] Executed DbCommand (123ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CRegistroProfesional` ON `TProfesional` (`CRegistroProfesional`);
2025-09-20 14:28:36.743 -05:00 [INF] Executed DbCommand (134ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TProfesional_NAreaFK` ON `TProfesional` (`NAreaFK`);
2025-09-20 14:28:36.883 -05:00 [INF] Executed DbCommand (138ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TProfesional_NEspecialidadFK` ON `TProfesional` (`NEspecialidadFK`);
2025-09-20 14:28:37.006 -05:00 [INF] Executed DbCommand (120ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_TProfesional_NPersonaFK` ON `TProfesional` (`NPersonaFK`);
2025-09-20 14:28:37.133 -05:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre7` ON `TRol` (`CNombre`);
2025-09-20 14:28:37.265 -05:00 [INF] Executed DbCommand (130ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre8` ON `TTipoIdentificacion` (`CNombre`);
2025-09-20 14:28:37.398 -05:00 [INF] Executed DbCommand (130ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CEmail` ON `TUsuario` (`CEmail`);
2025-09-20 14:28:37.532 -05:00 [INF] Executed DbCommand (132ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TUsuario_NEstadoUsuarioFK` ON `TUsuario` (`NEstadoUsuarioFK`);
2025-09-20 14:28:37.660 -05:00 [INF] Executed DbCommand (125ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TUsuario_NEstadoVerificacionFK` ON `TUsuario` (`NEstadoVerificacionFK`);
2025-09-20 14:28:37.790 -05:00 [INF] Executed DbCommand (127ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TUsuario_NRolFK` ON `TUsuario` (`NRolFK`);
2025-09-20 14:28:38.046 -05:00 [INF] User profile is available. Using 'C:\Users\ronal\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-20 14:28:38.171 -05:00 [INF] Now listening on: http://[::]:5000
2025-09-20 14:28:38.174 -05:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-20 14:28:38.176 -05:00 [INF] Hosting environment: Production
2025-09-20 14:28:38.177 -05:00 [INF] Content root path: C:\Users\ronal\Desktop\Archivos\Api_Mediconnet_Onion\api
2025-09-20 14:29:57.847 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/Usuario - null null
2025-09-20 14:29:57.874 -05:00 [WRN] Failed to determine the https port for redirect.
2025-09-20 14:29:57.879 -05:00 [INF] CORS policy execution successful.
2025-09-20 14:29:57.890 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/Usuario - 204 null null 43.4973ms
2025-09-20 14:29:57.897 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/Usuario - application/json 100
2025-09-20 14:29:57.902 -05:00 [INF] CORS policy execution successful.
2025-09-20 14:29:57.934 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 14:29:57.954 -05:00 [INF] Route matched with {action = "PostUsuario", controller = "Usuario"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostUsuario(Api_Mediconnet.Application.DTOs.TUsuarioCreateDTO) on controller Api_Mediconnet.Api.Controllers.UsuarioController (Api_Mediconnet.Api).
2025-09-20 14:29:59.256 -05:00 [INF] Executed DbCommand (321ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 255), @p2='?' (Size = 50), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TUsuario` (`CApellido`, `CEmail`, `CNombre`, `CPassword`, `DFechaRegistro`, `NEstadoUsuarioFK`, `NEstadoVerificacionFK`, `NRolFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `nUsuarioID`
FROM `TUsuario`
WHERE ROW_COUNT() = 1 AND `nUsuarioID` = LAST_INSERT_ID();
2025-09-20 14:29:59.415 -05:00 [INF] Usuario con ID 1 creado exitosamente.
2025-09-20 14:29:59.995 -05:00 [INF] Executed DbCommand (143ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t0`.`CNombre`
FROM `TUsuario` AS `t`
INNER JOIN `TRol` AS `t0` ON `t`.`NRolFK` = `t0`.`NRolID`
WHERE `t`.`nUsuarioID` = @__id_0
LIMIT 1
2025-09-20 14:30:00.038 -05:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-20 14:30:00.065 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api) in 2103.0486ms
2025-09-20 14:30:00.070 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 14:30:00.081 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/Usuario - 200 null application/json; charset=utf-8 2184.0154ms
2025-09-20 14:30:00.086 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - null null
2025-09-20 14:30:00.090 -05:00 [INF] CORS policy execution successful.
2025-09-20 14:30:00.092 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - 204 null null 6.0871ms
2025-09-20 14:30:00.099 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - application/json 2
2025-09-20 14:30:00.101 -05:00 [INF] CORS policy execution successful.
2025-09-20 14:30:00.145 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 14:30:00.150 -05:00 [INF] Route matched with {action = "PostEmailCode", controller = "EmailCode"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] PostEmailCode() on controller Api_Mediconnet.Api.Controllers.EmailCodeController (Api_Mediconnet.Api).
2025-09-20 14:30:00.708 -05:00 [INF] Executed DbCommand (121ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`nUsuarioID`, `t`.`CApellido`, `t`.`CEmail`, `t`.`CNombre`, `t`.`CPassword`, `t`.`DFechaRegistro`, `t`.`NEstadoUsuarioFK`, `t`.`NEstadoVerificacionFK`, `t`.`NRolFK`
FROM `TUsuario` AS `t`
WHERE `t`.`nUsuarioID` = @__p_0
LIMIT 1
2025-09-20 14:30:00.713 -05:00 [INF] Email del usuario con ID 1 recuperado correctamente.
2025-09-20 14:30:01.349 -05:00 [INF] Executed DbCommand (255ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 25), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TCodigoVerificacion` (`CCodigo`, `DFechaCreacion`, `DFechaExpiracion`, `ETipoCodigo`, `NIntentos`, `NUsuarioFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT `NCodigoVerificacionID`, `BUsado`
FROM `TCodigoVerificacion`
WHERE ROW_COUNT() = 1 AND `NCodigoVerificacionID` = LAST_INSERT_ID();
2025-09-20 14:30:01.469 -05:00 [INF] Código de Verificación creado correctamente con ID 1.
2025-09-20 14:30:04.122 -05:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-20 14:30:04.125 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api) in 3972.2824ms
2025-09-20 14:30:04.128 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 14:30:04.130 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 200 0 null 4031.6134ms
2025-09-20 14:32:05.814 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - null null
2025-09-20 14:32:05.815 -05:00 [INF] CORS policy execution successful.
2025-09-20 14:32:05.816 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - 204 null null 2.48ms
2025-09-20 14:32:05.819 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - application/json 21
2025-09-20 14:32:05.821 -05:00 [INF] CORS policy execution successful.
2025-09-20 14:32:05.827 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 14:32:05.829 -05:00 [INF] Route matched with {action = "PostEmailCode", controller = "EmailCode"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] PostEmailCode() on controller Api_Mediconnet.Api.Controllers.EmailCodeController (Api_Mediconnet.Api).
2025-09-20 14:32:06.288 -05:00 [INF] Executed DbCommand (109ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`nUsuarioID`, `t`.`CApellido`, `t`.`CEmail`, `t`.`CNombre`, `t`.`CPassword`, `t`.`DFechaRegistro`, `t`.`NEstadoUsuarioFK`, `t`.`NEstadoVerificacionFK`, `t`.`NRolFK`
FROM `TUsuario` AS `t`
WHERE `t`.`nUsuarioID` = @__p_0
LIMIT 1
2025-09-20 14:32:06.290 -05:00 [INF] Email del usuario con ID 1 recuperado correctamente.
2025-09-20 14:32:06.865 -05:00 [INF] Executed DbCommand (114ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 25), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TCodigoVerificacion` (`CCodigo`, `DFechaCreacion`, `DFechaExpiracion`, `ETipoCodigo`, `NIntentos`, `NUsuarioFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT `NCodigoVerificacionID`, `BUsado`
FROM `TCodigoVerificacion`
WHERE ROW_COUNT() = 1 AND `NCodigoVerificacionID` = LAST_INSERT_ID();
2025-09-20 14:32:06.996 -05:00 [INF] Código de Verificación creado correctamente con ID 2.
2025-09-20 14:32:09.456 -05:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-20 14:32:09.458 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api) in 3627.5803ms
2025-09-20 14:32:09.461 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 14:32:09.463 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 200 0 null 3644.0649ms
2025-09-20 15:13:15.824 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM information_schema.tables
WHERE table_type = 'BASE TABLE' AND table_schema = 'Api_Mediconnet_Onion'
2025-09-20 15:13:15.965 -05:00 [INF] User profile is available. Using 'C:\Users\ronal\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-20 15:13:16.036 -05:00 [INF] Now listening on: http://[::]:5000
2025-09-20 15:13:16.040 -05:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-20 15:13:16.041 -05:00 [INF] Hosting environment: Production
2025-09-20 15:13:16.042 -05:00 [INF] Content root path: C:\Users\ronal\Desktop\Archivos\Api_Mediconnet_Onion\api
2025-09-20 15:32:26.276 -05:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM information_schema.tables
WHERE table_type = 'BASE TABLE' AND table_schema = 'Api_Mediconnet_Onion'
2025-09-20 15:32:26.442 -05:00 [INF] User profile is available. Using 'C:\Users\ronal\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-20 15:32:26.509 -05:00 [INF] Now listening on: http://[::]:5000
2025-09-20 15:32:26.514 -05:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-20 15:32:26.515 -05:00 [INF] Hosting environment: Production
2025-09-20 15:32:26.518 -05:00 [INF] Content root path: C:\Users\ronal\Desktop\Archivos\Api_Mediconnet_Onion\api
2025-09-20 15:40:36.434 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM information_schema.tables
WHERE table_type = 'BASE TABLE' AND table_schema = 'Api_Mediconnet_Onion'
2025-09-20 15:40:36.573 -05:00 [INF] User profile is available. Using 'C:\Users\ronal\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-20 15:40:36.635 -05:00 [INF] Now listening on: http://[::]:5000
2025-09-20 15:40:36.640 -05:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-20 15:40:36.641 -05:00 [INF] Hosting environment: Production
2025-09-20 15:40:36.641 -05:00 [INF] Content root path: C:\Users\ronal\Desktop\Archivos\Api_Mediconnet_Onion\api
2025-09-20 17:05:49.595 -05:00 [INF] Executed DbCommand (128ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM information_schema.tables
WHERE table_type = 'BASE TABLE' AND table_schema = 'Api_Mediconnet_Onion'
2025-09-20 17:05:49.749 -05:00 [INF] User profile is available. Using 'C:\Users\ronal\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-20 17:05:49.817 -05:00 [INF] Now listening on: http://[::]:5000
2025-09-20 17:05:49.820 -05:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-20 17:05:49.822 -05:00 [INF] Hosting environment: Production
2025-09-20 17:05:49.822 -05:00 [INF] Content root path: C:\Users\ronal\Desktop\Archivos\Api_Mediconnet_Onion\api
2025-09-20 17:06:21.452 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - null null
2025-09-20 17:06:21.481 -05:00 [WRN] Failed to determine the https port for redirect.
2025-09-20 17:06:21.487 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:06:21.498 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - 204 null null 47.2079ms
2025-09-20 17:06:21.506 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - application/json 18
2025-09-20 17:06:21.512 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:06:21.581 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '20/09/2025 8:30:00 p. m.', Current time (UTC): '20/09/2025 10:06:21 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:06:21.600 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '20/09/2025 8:30:00 p. m.', Current time (UTC): '20/09/2025 10:06:21 p. m.'.
2025-09-20 17:06:21.608 -05:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-20 17:06:21.614 -05:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-20 17:06:21.617 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 401 0 null 111.5307ms
2025-09-20 17:06:35.207 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/Usuario - null null
2025-09-20 17:06:35.211 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:06:35.213 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/Usuario - 204 null null 5.769ms
2025-09-20 17:06:35.217 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/Usuario - application/json 101
2025-09-20 17:06:35.220 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:06:35.228 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:06:35.255 -05:00 [INF] Route matched with {action = "PostUsuario", controller = "Usuario"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostUsuario(Api_Mediconnet.Application.DTOs.TUsuarioCreateDTO) on controller Api_Mediconnet.Api.Controllers.UsuarioController (Api_Mediconnet.Api).
2025-09-20 17:06:36.720 -05:00 [INF] Executed DbCommand (406ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 255), @p2='?' (Size = 50), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TUsuario` (`CApellido`, `CEmail`, `CNombre`, `CPassword`, `DFechaRegistro`, `NEstadoUsuarioFK`, `NEstadoVerificacionFK`, `NRolFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `nUsuarioID`
FROM `TUsuario`
WHERE ROW_COUNT() = 1 AND `nUsuarioID` = LAST_INSERT_ID();
2025-09-20 17:06:36.887 -05:00 [INF] Usuario con ID 2 creado exitosamente.
2025-09-20 17:06:37.743 -05:00 [INF] Executed DbCommand (410ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t0`.`CNombre`
FROM `TUsuario` AS `t`
INNER JOIN `TRol` AS `t0` ON `t`.`NRolFK` = `t0`.`NRolID`
WHERE `t`.`nUsuarioID` = @__id_0
LIMIT 1
2025-09-20 17:06:37.764 -05:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-20 17:06:37.792 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api) in 2527.4573ms
2025-09-20 17:06:37.794 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:06:37.801 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/Usuario - 200 null application/json; charset=utf-8 2584.3559ms
2025-09-20 17:06:37.805 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - null null
2025-09-20 17:06:37.808 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:06:37.809 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - 204 null null 4.341ms
2025-09-20 17:06:37.814 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - application/json 2
2025-09-20 17:06:37.818 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:06:37.830 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:06:37.837 -05:00 [INF] Route matched with {action = "PostEmailCode", controller = "EmailCode"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] PostEmailCode() on controller Api_Mediconnet.Api.Controllers.EmailCodeController (Api_Mediconnet.Api).
2025-09-20 17:06:38.512 -05:00 [INF] Executed DbCommand (108ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`nUsuarioID`, `t`.`CApellido`, `t`.`CEmail`, `t`.`CNombre`, `t`.`CPassword`, `t`.`DFechaRegistro`, `t`.`NEstadoUsuarioFK`, `t`.`NEstadoVerificacionFK`, `t`.`NRolFK`
FROM `TUsuario` AS `t`
WHERE `t`.`nUsuarioID` = @__p_0
LIMIT 1
2025-09-20 17:06:38.521 -05:00 [INF] Email del usuario con ID 2 recuperado correctamente.
2025-09-20 17:06:39.240 -05:00 [INF] Executed DbCommand (226ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 25), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TCodigoVerificacion` (`CCodigo`, `DFechaCreacion`, `DFechaExpiracion`, `ETipoCodigo`, `NIntentos`, `NUsuarioFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT `NCodigoVerificacionID`, `BUsado`
FROM `TCodigoVerificacion`
WHERE ROW_COUNT() = 1 AND `NCodigoVerificacionID` = LAST_INSERT_ID();
2025-09-20 17:06:39.349 -05:00 [INF] Código de Verificación creado correctamente con ID 3.
2025-09-20 17:06:41.952 -05:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-20 17:06:41.954 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api) in 4113.9407ms
2025-09-20 17:06:41.956 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:06:41.958 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 200 0 null 4143.8812ms
2025-09-20 17:06:54.140 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - null null
2025-09-20 17:06:54.143 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:06:54.144 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - 204 null null 4.1834ms
2025-09-20 17:06:54.148 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - application/json 20
2025-09-20 17:06:54.151 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:06:54.154 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:06:54.155 -05:00 [INF] Route matched with {action = "PostEmailCode", controller = "EmailCode"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] PostEmailCode() on controller Api_Mediconnet.Api.Controllers.EmailCodeController (Api_Mediconnet.Api).
2025-09-20 17:06:54.727 -05:00 [INF] Executed DbCommand (104ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`nUsuarioID`, `t`.`CApellido`, `t`.`CEmail`, `t`.`CNombre`, `t`.`CPassword`, `t`.`DFechaRegistro`, `t`.`NEstadoUsuarioFK`, `t`.`NEstadoVerificacionFK`, `t`.`NRolFK`
FROM `TUsuario` AS `t`
WHERE `t`.`nUsuarioID` = @__p_0
LIMIT 1
2025-09-20 17:06:54.730 -05:00 [INF] Email del usuario con ID 2 recuperado correctamente.
2025-09-20 17:06:55.259 -05:00 [INF] Executed DbCommand (214ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 25), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TCodigoVerificacion` (`CCodigo`, `DFechaCreacion`, `DFechaExpiracion`, `ETipoCodigo`, `NIntentos`, `NUsuarioFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT `NCodigoVerificacionID`, `BUsado`
FROM `TCodigoVerificacion`
WHERE ROW_COUNT() = 1 AND `NCodigoVerificacionID` = LAST_INSERT_ID();
2025-09-20 17:06:55.371 -05:00 [INF] Código de Verificación creado correctamente con ID 4.
2025-09-20 17:06:57.637 -05:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-20 17:06:57.638 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api) in 3480.6006ms
2025-09-20 17:06:57.640 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:06:57.642 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 200 0 null 3493.5858ms
2025-09-20 17:07:12.367 -05:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Api/EmailCode - null null
2025-09-20 17:07:12.374 -05:00 [INF] Executing endpoint '405 HTTP Method Not Supported'
2025-09-20 17:07:12.375 -05:00 [INF] Executed endpoint '405 HTTP Method Not Supported'
2025-09-20 17:07:12.376 -05:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Api/EmailCode - 405 0 null 9.1113ms
2025-09-20 17:08:40.121 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/Usuario - application/json 138
2025-09-20 17:08:40.125 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:08:40 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:08:40.128 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:08:40 p. m.'.
2025-09-20 17:08:40.130 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:08:40.132 -05:00 [INF] Route matched with {action = "PostUsuario", controller = "Usuario"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostUsuario(Api_Mediconnet.Application.DTOs.TUsuarioCreateDTO) on controller Api_Mediconnet.Api.Controllers.UsuarioController (Api_Mediconnet.Api).
2025-09-20 17:08:40.891 -05:00 [ERR] Failed executing DbCommand (111ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 255), @p2='?' (Size = 50), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TUsuario` (`CApellido`, `CEmail`, `CNombre`, `CPassword`, `DFechaRegistro`, `NEstadoUsuarioFK`, `NEstadoVerificacionFK`, `NRolFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `nUsuarioID`
FROM `TUsuario`
WHERE ROW_COUNT() = 1 AND `nUsuarioID` = LAST_INSERT_ID();
2025-09-20 17:08:41.029 -05:00 [ERR] An exception occurred in the database while saving changes for context type 'Api_Mediconnet.Infrastructure.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry 'ronaldstevenrios@gmail.com' for key 'TUsuario.CEmail'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry 'ronaldstevenrios@gmail.com' for key 'TUsuario.CEmail'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-20 17:08:41.043 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api) in 908.4015ms
2025-09-20 17:08:41.046 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:08:41.050 -05:00 [ERR] Se produjo un error no controlado.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Duplicate entry 'ronaldstevenrios@gmail.com' for key 'TUsuario.CEmail'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Api_Mediconnet.Infrastructure.Repositories.TUsuarioRepository.SaveChangesAsync() in C:\Users\ronal\Desktop\Archivos\Api_Mediconnet_Onion\Infrastructure\Repositories\TUsuariosRepository.cs:line 45
   at Api_Mediconnet.Application.Services.TUsuarioService.CrearAsync(TUsuarioCreateDTO dTO) in C:\Users\ronal\Desktop\Archivos\Api_Mediconnet_Onion\Application\Services\TUsuarioService.cs:line 78
   at Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario(TUsuarioCreateDTO usuarioCreateDTO) in C:\Users\ronal\Desktop\Archivos\Api_Mediconnet_Onion\api\Controllers\UsuarioController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Api_Mediconnet.Api.Middleware.ErrorHandlingMiddleware.Invoke(HttpContext httpContent) in C:\Users\ronal\Desktop\Archivos\Api_Mediconnet_Onion\api\Middleware\ErrorHandlingMiddleware.cs:line 21
2025-09-20 17:08:41.134 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/Usuario - 500 null application/json 1013.1162ms
2025-09-20 17:09:32.948 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/Usuario - application/json 138
2025-09-20 17:09:32.951 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:09:32 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:09:32.955 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:09:32 p. m.'.
2025-09-20 17:09:32.956 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:09:32.959 -05:00 [INF] Route matched with {action = "PostUsuario", controller = "Usuario"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostUsuario(Api_Mediconnet.Application.DTOs.TUsuarioCreateDTO) on controller Api_Mediconnet.Api.Controllers.UsuarioController (Api_Mediconnet.Api).
2025-09-20 17:09:33.726 -05:00 [INF] Executed DbCommand (232ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 255), @p2='?' (Size = 50), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TUsuario` (`CApellido`, `CEmail`, `CNombre`, `CPassword`, `DFechaRegistro`, `NEstadoUsuarioFK`, `NEstadoVerificacionFK`, `NRolFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `nUsuarioID`
FROM `TUsuario`
WHERE ROW_COUNT() = 1 AND `nUsuarioID` = LAST_INSERT_ID();
2025-09-20 17:09:33.840 -05:00 [INF] Usuario con ID 4 creado exitosamente.
2025-09-20 17:09:34.057 -05:00 [INF] Executed DbCommand (111ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t0`.`CNombre`
FROM `TUsuario` AS `t`
INNER JOIN `TRol` AS `t0` ON `t`.`NRolFK` = `t0`.`NRolID`
WHERE `t`.`nUsuarioID` = @__id_0
LIMIT 1
2025-09-20 17:09:34.061 -05:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-20 17:09:34.064 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api) in 1101.9268ms
2025-09-20 17:09:34.066 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:09:34.067 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/Usuario - 200 null application/json; charset=utf-8 1119.3982ms
2025-09-20 17:09:52.128 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - null 0
2025-09-20 17:09:52.131 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '19/09/2025 4:59:10 p. m.', Current time (UTC): '20/09/2025 10:09:52 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:09:52.134 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '19/09/2025 4:59:10 p. m.', Current time (UTC): '20/09/2025 10:09:52 p. m.'.
2025-09-20 17:09:52.136 -05:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-20 17:09:52.139 -05:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-20 17:09:52.141 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 401 0 null 12.5539ms
2025-09-20 17:11:11.693 -05:00 [INF] Executed DbCommand (107ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE DATABASE `Api_Mediconnet_Onion`;
2025-09-20 17:11:14.458 -05:00 [INF] Executed DbCommand (101ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER DATABASE CHARACTER SET utf8mb4;
2025-09-20 17:11:14.583 -05:00 [INF] Executed DbCommand (123ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TArea` (
    `NAreaID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    `CDescripcion` varchar(1000) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NAreaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:14.698 -05:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TDiaSemana` (
    `NDiaSemanaID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NDiaSemanaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:14.815 -05:00 [INF] Executed DbCommand (113ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEspecialidad` (
    `NEspecialidadID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    `CDescripcion` varchar(100) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEspecialidadID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:14.941 -05:00 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEstadoCita` (
    `NEstadoCitaID` int(6) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEstadoCitaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:15.050 -05:00 [INF] Executed DbCommand (105ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEstadoUsuario` (
    `NEstadoUsuarioID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(20) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEstadoUsuarioID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:15.160 -05:00 [INF] Executed DbCommand (109ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEstadoVerificacion` (
    `NEstadoVerificacion` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEstadoVerificacion`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:15.274 -05:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TGrupoSanguineo` (
    `NGrupoSanguineoID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(10) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NGrupoSanguineoID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:15.402 -05:00 [INF] Executed DbCommand (123ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TRol` (
    `NRolID` int(32) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(20) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NRolID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:15.521 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TTipoIdentificacion` (
    `NTipoIdentificacion` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NTipoIdentificacion`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:15.642 -05:00 [INF] Executed DbCommand (118ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TUsuario` (
    `nUsuarioID` int(32) NOT NULL AUTO_INCREMENT,
    `NEstadoVerificacionFK` int(12) NOT NULL,
    `NEstadoUsuarioFK` int(12) NOT NULL,
    `NRolFK` int(12) NOT NULL,
    `CNombre` varchar(50) CHARACTER SET utf8mb4 NOT NULL,
    `CApellido` varchar(100) CHARACTER SET utf8mb4 NOT NULL,
    `CEmail` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `CPassword` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaRegistro` DateTime NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`nUsuarioID`),
    CONSTRAINT `FK_Usuario_EstadoUsuario` FOREIGN KEY (`NEstadoUsuarioFK`) REFERENCES `TEstadoUsuario` (`NEstadoUsuarioID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_Usuario_EstadoVerificacion` FOREIGN KEY (`NEstadoVerificacionFK`) REFERENCES `TEstadoVerificacion` (`NEstadoVerificacion`) ON DELETE RESTRICT,
    CONSTRAINT `FK_Usuario_Rol` FOREIGN KEY (`NRolFK`) REFERENCES `TRol` (`NRolID`) ON DELETE RESTRICT
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:15.757 -05:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TCodigoVerificacion` (
    `NCodigoVerificacionID` int(32) NOT NULL AUTO_INCREMENT,
    `NUsuarioFK` int(6) NOT NULL,
    `CCodigo` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `ETipoCodigo` varchar(25) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaExpiracion` datetime NOT NULL,
    `BUsado` tinyint(1) NOT NULL DEFAULT FALSE,
    `NIntentos` int(11) NOT NULL,
    `DFechaCreacion` datetime NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NCodigoVerificacionID`),
    CONSTRAINT `FK_CodigoVerificacion_Usuario` FOREIGN KEY (`NUsuarioFK`) REFERENCES `TUsuario` (`nUsuarioID`) ON DELETE RESTRICT
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:15.877 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TLogins` (
    `NLoginID` int(32) NOT NULL AUTO_INCREMENT,
    `DFechaLogin` DateTime NOT NULL,
    `NUsuarioFK` int(32) NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NLoginID`),
    CONSTRAINT `FK_Usuario_Logins` FOREIGN KEY (`NUsuarioFK`) REFERENCES `TUsuario` (`nUsuarioID`) ON DELETE RESTRICT
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:15.995 -05:00 [INF] Executed DbCommand (116ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TPersona` (
    `NPersonaID` int(32) NOT NULL AUTO_INCREMENT,
    `NUsuarioFK` int(32) NOT NULL,
    `NTipoIdentificacionFK` int(32) NOT NULL,
    `CNroIdentificacion` varchar(20) CHARACTER SET utf8mb4 NOT NULL,
    `CNroConctacto` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    `CDireccion` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaNacimiento` DateTime NOT NULL,
    `ESexo` varchar(25) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NPersonaID`),
    CONSTRAINT `FK_Personas_TipoIdentificacion` FOREIGN KEY (`NTipoIdentificacionFK`) REFERENCES `TTipoIdentificacion` (`NTipoIdentificacion`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TPersona_TUsuario_NUsuarioFK` FOREIGN KEY (`NUsuarioFK`) REFERENCES `TUsuario` (`nUsuarioID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:16.123 -05:00 [INF] Executed DbCommand (125ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TPaciente` (
    `NPacienteID` int(32) NOT NULL AUTO_INCREMENT,
    `NPersonaFK` int(32) NOT NULL,
    `NGrupoSanguineoFK` int(6) NOT NULL,
    `CAlergiasGenerales` varchar(2000) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NPacienteID`),
    CONSTRAINT `FK_Paciente_GrupoSanguineo` FOREIGN KEY (`NGrupoSanguineoFK`) REFERENCES `TGrupoSanguineo` (`NGrupoSanguineoID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TPaciente_TPersona_NPersonaFK` FOREIGN KEY (`NPersonaFK`) REFERENCES `TPersona` (`NPersonaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:16.246 -05:00 [INF] Executed DbCommand (120ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TProfesional` (
    `NProfesionalID` int(32) NOT NULL AUTO_INCREMENT,
    `NPersonaFK` int(32) NOT NULL,
    `NEspecialidadFK` int(12) NOT NULL,
    `NAreaFK` int(12) NOT NULL,
    `CRegistroProfesional` varchar(50) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaContratacion` DateTime NOT NULL,
    `ETipoProfesional` varchar(25) CHARACTER SET utf8mb4 NOT NULL,
    `CBiografia` varchar(2000) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NProfesionalID`),
    CONSTRAINT `FK_Profesional_Area` FOREIGN KEY (`NAreaFK`) REFERENCES `TArea` (`NAreaID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_Profesional_Especialidad` FOREIGN KEY (`NEspecialidadFK`) REFERENCES `TEspecialidad` (`NEspecialidadID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TProfesional_TPersona_NPersonaFK` FOREIGN KEY (`NPersonaFK`) REFERENCES `TPersona` (`NPersonaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:16.442 -05:00 [INF] Executed DbCommand (192ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TCita` (
    `NCitaID` int(12) NOT NULL AUTO_INCREMENT,
    `NEstadoCitaFK` int(12) NOT NULL,
    `NProfesionalFK` int(12) NOT NULL,
    `NPacienteFK` int(12) NOT NULL,
    `NDiaSemanaFK` int(12) NOT NULL,
    `DFecha` datetime NOT NULL,
    `DHora` time NOT NULL,
    `DDuracion` time NOT NULL,
    `CObservacion` varchar(500) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaRegistro` datetime NOT NULL,
    `ProfesionalNProfesionalID` int(32) NOT NULL,
    `PacienteNPacienteID` int(32) NOT NULL,
    `EstadoNEstadoCitaID` int(6) NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NCitaID`),
    CONSTRAINT `FK_Cita_DiaSemana` FOREIGN KEY (`NDiaSemanaFK`) REFERENCES `TDiaSemana` (`NDiaSemanaID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TCita_TEstadoCita_EstadoNEstadoCitaID` FOREIGN KEY (`EstadoNEstadoCitaID`) REFERENCES `TEstadoCita` (`NEstadoCitaID`) ON DELETE CASCADE,
    CONSTRAINT `FK_TCita_TPaciente_PacienteNPacienteID` FOREIGN KEY (`PacienteNPacienteID`) REFERENCES `TPaciente` (`NPacienteID`) ON DELETE CASCADE,
    CONSTRAINT `FK_TCita_TProfesional_ProfesionalNProfesionalID` FOREIGN KEY (`ProfesionalNProfesionalID`) REFERENCES `TProfesional` (`NProfesionalID`) ON DELETE CASCADE
) CHARACTER SET=utf8mb4;
2025-09-20 17:11:16.549 -05:00 [INF] Executed DbCommand (104ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TDiaSemana` (`NDiaSemanaID`, `CNombre`)
VALUES (1, 'Lunes'),
(2, 'Martes'),
(3, 'Miércoles'),
(4, 'Jueves'),
(5, 'Viernes'),
(6, 'Sábado'),
(7, 'Domingo');
2025-09-20 17:11:16.658 -05:00 [INF] Executed DbCommand (106ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TEstadoUsuario` (`NEstadoUsuarioID`, `CNombre`)
VALUES (1, 'Activo'),
(2, 'Inactivo');
2025-09-20 17:11:16.767 -05:00 [INF] Executed DbCommand (107ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TEstadoVerificacion` (`NEstadoVerificacion`, `CNombre`)
VALUES (1, 'No Verificado'),
(2, 'Verificado');
2025-09-20 17:11:16.873 -05:00 [INF] Executed DbCommand (104ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TGrupoSanguineo` (`NGrupoSanguineoID`, `CNombre`)
VALUES (1, 'A+'),
(2, 'A-'),
(3, 'B+'),
(4, 'B-'),
(5, 'AB+'),
(6, 'AB-'),
(7, 'O+'),
(8, 'O-');
2025-09-20 17:11:16.988 -05:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TRol` (`NRolID`, `CNombre`)
VALUES (1, 'Administrador'),
(2, 'Paciente'),
(3, 'Medico');
2025-09-20 17:11:17.090 -05:00 [INF] Executed DbCommand (99ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TTipoIdentificacion` (`NTipoIdentificacion`, `CNombre`)
VALUES (1, 'Cédula de ciudadanía'),
(2, 'Tarjeta de identidad'),
(3, 'Registro civil de nacimiento'),
(4, 'Cédula de extranjería'),
(5, 'Pasaporte');
2025-09-20 17:11:17.235 -05:00 [INF] Executed DbCommand (141ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre` ON `TArea` (`CNombre`);
2025-09-20 17:11:17.358 -05:00 [INF] Executed DbCommand (120ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_EstadoNEstadoCitaID` ON `TCita` (`EstadoNEstadoCitaID`);
2025-09-20 17:11:17.471 -05:00 [INF] Executed DbCommand (109ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_NDiaSemanaFK` ON `TCita` (`NDiaSemanaFK`);
2025-09-20 17:11:17.596 -05:00 [INF] Executed DbCommand (123ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_PacienteNPacienteID` ON `TCita` (`PacienteNPacienteID`);
2025-09-20 17:11:17.713 -05:00 [INF] Executed DbCommand (113ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_ProfesionalNProfesionalID` ON `TCita` (`ProfesionalNProfesionalID`);
2025-09-20 17:11:17.828 -05:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CCodigo` ON `TCodigoVerificacion` (`CCodigo`);
2025-09-20 17:11:17.937 -05:00 [INF] Executed DbCommand (107ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCodigoVerificacion_NUsuarioFK` ON `TCodigoVerificacion` (`NUsuarioFK`);
2025-09-20 17:11:18.061 -05:00 [INF] Executed DbCommand (122ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre1` ON `TDiaSemana` (`CNombre`);
2025-09-20 17:11:18.175 -05:00 [INF] Executed DbCommand (110ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre2` ON `TEspecialidad` (`CNombre`);
2025-09-20 17:11:18.295 -05:00 [INF] Executed DbCommand (115ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre3` ON `TEstadoCita` (`CNombre`);
2025-09-20 17:11:18.419 -05:00 [INF] Executed DbCommand (122ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre4` ON `TEstadoUsuario` (`CNombre`);
2025-09-20 17:11:18.540 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre5` ON `TEstadoVerificacion` (`CNombre`);
2025-09-20 17:11:18.668 -05:00 [INF] Executed DbCommand (125ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre6` ON `TGrupoSanguineo` (`CNombre`);
2025-09-20 17:11:18.784 -05:00 [INF] Executed DbCommand (114ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TLogins_NUsuarioFK` ON `TLogins` (`NUsuarioFK`);
2025-09-20 17:11:18.906 -05:00 [INF] Executed DbCommand (118ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TPaciente_NGrupoSanguineoFK` ON `TPaciente` (`NGrupoSanguineoFK`);
2025-09-20 17:11:19.031 -05:00 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_TPaciente_NPersonaFK` ON `TPaciente` (`NPersonaFK`);
2025-09-20 17:11:19.161 -05:00 [INF] Executed DbCommand (127ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNroIdentificacion` ON `TPersona` (`CNroIdentificacion`);
2025-09-20 17:11:19.279 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TPersona_NTipoIdentificacionFK` ON `TPersona` (`NTipoIdentificacionFK`);
2025-09-20 17:11:19.402 -05:00 [INF] Executed DbCommand (119ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_TPersona_NUsuarioFK` ON `TPersona` (`NUsuarioFK`);
2025-09-20 17:11:19.525 -05:00 [INF] Executed DbCommand (119ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CRegistroProfesional` ON `TProfesional` (`CRegistroProfesional`);
2025-09-20 17:11:19.681 -05:00 [INF] Executed DbCommand (152ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TProfesional_NAreaFK` ON `TProfesional` (`NAreaFK`);
2025-09-20 17:11:19.811 -05:00 [INF] Executed DbCommand (128ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TProfesional_NEspecialidadFK` ON `TProfesional` (`NEspecialidadFK`);
2025-09-20 17:11:19.951 -05:00 [INF] Executed DbCommand (136ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_TProfesional_NPersonaFK` ON `TProfesional` (`NPersonaFK`);
2025-09-20 17:11:20.074 -05:00 [INF] Executed DbCommand (120ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre7` ON `TRol` (`CNombre`);
2025-09-20 17:11:20.202 -05:00 [INF] Executed DbCommand (125ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre8` ON `TTipoIdentificacion` (`CNombre`);
2025-09-20 17:11:20.329 -05:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CEmail` ON `TUsuario` (`CEmail`);
2025-09-20 17:11:20.449 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TUsuario_NEstadoUsuarioFK` ON `TUsuario` (`NEstadoUsuarioFK`);
2025-09-20 17:11:20.581 -05:00 [INF] Executed DbCommand (128ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TUsuario_NEstadoVerificacionFK` ON `TUsuario` (`NEstadoVerificacionFK`);
2025-09-20 17:11:20.702 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TUsuario_NRolFK` ON `TUsuario` (`NRolFK`);
2025-09-20 17:11:20.902 -05:00 [INF] User profile is available. Using 'C:\Users\ronal\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-20 17:11:20.979 -05:00 [INF] Now listening on: http://[::]:5000
2025-09-20 17:11:20.983 -05:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-20 17:11:20.984 -05:00 [INF] Hosting environment: Production
2025-09-20 17:11:20.984 -05:00 [INF] Content root path: C:\Users\ronal\Desktop\Archivos\Api_Mediconnet_Onion\api
2025-09-20 17:11:28.197 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/Usuario - application/json 138
2025-09-20 17:11:28.238 -05:00 [WRN] Failed to determine the https port for redirect.
2025-09-20 17:11:28.335 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:11:28 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:11:28.360 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:11:28 p. m.'.
2025-09-20 17:11:28.365 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:11:28.406 -05:00 [INF] Route matched with {action = "PostUsuario", controller = "Usuario"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostUsuario(Api_Mediconnet.Application.DTOs.TUsuarioCreateDTO) on controller Api_Mediconnet.Api.Controllers.UsuarioController (Api_Mediconnet.Api).
2025-09-20 17:11:29.374 -05:00 [INF] Executed DbCommand (142ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 255), @p2='?' (Size = 50), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TUsuario` (`CApellido`, `CEmail`, `CNombre`, `CPassword`, `DFechaRegistro`, `NEstadoUsuarioFK`, `NEstadoVerificacionFK`, `NRolFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `nUsuarioID`
FROM `TUsuario`
WHERE ROW_COUNT() = 1 AND `nUsuarioID` = LAST_INSERT_ID();
2025-09-20 17:11:29.525 -05:00 [INF] Usuario con ID 1 creado exitosamente.
2025-09-20 17:11:30.085 -05:00 [INF] Executed DbCommand (105ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t0`.`CNombre`
FROM `TUsuario` AS `t`
INNER JOIN `TRol` AS `t0` ON `t`.`NRolFK` = `t0`.`NRolID`
WHERE `t`.`nUsuarioID` = @__id_0
LIMIT 1
2025-09-20 17:11:30.111 -05:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-20 17:11:30.147 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api) in 1732.769ms
2025-09-20 17:11:30.151 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:11:30.160 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/Usuario - 200 null application/json; charset=utf-8 1963.6854ms
2025-09-20 17:11:46.956 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - null 0
2025-09-20 17:11:46.962 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '19/09/2025 4:59:10 p. m.', Current time (UTC): '20/09/2025 10:11:46 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:11:46.966 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '19/09/2025 4:59:10 p. m.', Current time (UTC): '20/09/2025 10:11:46 p. m.'.
2025-09-20 17:11:46.975 -05:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-20 17:11:46.987 -05:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-20 17:11:46.991 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 401 0 null 34.9482ms
2025-09-20 17:13:45.945 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - null 0
2025-09-20 17:13:45.950 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '19/09/2025 4:59:10 p. m.', Current time (UTC): '20/09/2025 10:13:45 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:13:45.953 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '19/09/2025 4:59:10 p. m.', Current time (UTC): '20/09/2025 10:13:45 p. m.'.
2025-09-20 17:13:45.956 -05:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-20 17:13:45.958 -05:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-20 17:13:45.959 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 401 0 null 14.0452ms
2025-09-20 17:14:23.339 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/Usuario - application/json 139
2025-09-20 17:14:23.347 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:14:23 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:14:23.349 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:14:23 p. m.'.
2025-09-20 17:14:23.351 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:14:23.362 -05:00 [INF] Route matched with {action = "PostUsuario", controller = "Usuario"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostUsuario(Api_Mediconnet.Application.DTOs.TUsuarioCreateDTO) on controller Api_Mediconnet.Api.Controllers.UsuarioController (Api_Mediconnet.Api).
2025-09-20 17:14:24.278 -05:00 [INF] Executed DbCommand (213ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 255), @p2='?' (Size = 50), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TUsuario` (`CApellido`, `CEmail`, `CNombre`, `CPassword`, `DFechaRegistro`, `NEstadoUsuarioFK`, `NEstadoVerificacionFK`, `NRolFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `nUsuarioID`
FROM `TUsuario`
WHERE ROW_COUNT() = 1 AND `nUsuarioID` = LAST_INSERT_ID();
2025-09-20 17:14:24.387 -05:00 [INF] Usuario con ID 2 creado exitosamente.
2025-09-20 17:14:24.743 -05:00 [INF] Executed DbCommand (119ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t0`.`CNombre`
FROM `TUsuario` AS `t`
INNER JOIN `TRol` AS `t0` ON `t`.`NRolFK` = `t0`.`NRolID`
WHERE `t`.`nUsuarioID` = @__id_0
LIMIT 1
2025-09-20 17:14:24.758 -05:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-20 17:14:24.766 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api) in 1401.2889ms
2025-09-20 17:14:24.777 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:14:24.795 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/Usuario - 200 null application/json; charset=utf-8 1455.9054ms
2025-09-20 17:14:44.406 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - null 0
2025-09-20 17:14:44.409 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '19/09/2025 4:59:10 p. m.', Current time (UTC): '20/09/2025 10:14:44 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:14:44.411 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '19/09/2025 4:59:10 p. m.', Current time (UTC): '20/09/2025 10:14:44 p. m.'.
2025-09-20 17:14:44.416 -05:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-20 17:14:44.418 -05:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-20 17:14:44.420 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 401 0 null 13.4806ms
2025-09-20 17:18:57.659 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/Usuario - application/json 140
2025-09-20 17:18:57.665 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:18:57 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:18:57.669 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:18:57 p. m.'.
2025-09-20 17:18:57.671 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:18:57.679 -05:00 [INF] Route matched with {action = "PostUsuario", controller = "Usuario"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostUsuario(Api_Mediconnet.Application.DTOs.TUsuarioCreateDTO) on controller Api_Mediconnet.Api.Controllers.UsuarioController (Api_Mediconnet.Api).
2025-09-20 17:19:00.363 -05:00 [INF] Executed DbCommand (228ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 255), @p2='?' (Size = 50), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TUsuario` (`CApellido`, `CEmail`, `CNombre`, `CPassword`, `DFechaRegistro`, `NEstadoUsuarioFK`, `NEstadoVerificacionFK`, `NRolFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `nUsuarioID`
FROM `TUsuario`
WHERE ROW_COUNT() = 1 AND `nUsuarioID` = LAST_INSERT_ID();
2025-09-20 17:19:00.474 -05:00 [INF] Usuario con ID 3 creado exitosamente.
2025-09-20 17:19:00.800 -05:00 [INF] Executed DbCommand (112ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t0`.`CNombre`
FROM `TUsuario` AS `t`
INNER JOIN `TRol` AS `t0` ON `t`.`NRolFK` = `t0`.`NRolID`
WHERE `t`.`nUsuarioID` = @__id_0
LIMIT 1
2025-09-20 17:19:00.808 -05:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-20 17:19:00.812 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api) in 3129.8123ms
2025-09-20 17:19:00.815 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:19:00.817 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/Usuario - 200 null application/json; charset=utf-8 3157.3414ms
2025-09-20 17:20:06.659 -05:00 [INF] Executed DbCommand (106ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE DATABASE `Api_Mediconnet_Onion`;
2025-09-20 17:20:08.644 -05:00 [INF] Executed DbCommand (107ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER DATABASE CHARACTER SET utf8mb4;
2025-09-20 17:20:08.760 -05:00 [INF] Executed DbCommand (113ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TArea` (
    `NAreaID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    `CDescripcion` varchar(1000) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NAreaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:08.875 -05:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TDiaSemana` (
    `NDiaSemanaID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NDiaSemanaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:08.990 -05:00 [INF] Executed DbCommand (112ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEspecialidad` (
    `NEspecialidadID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    `CDescripcion` varchar(100) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEspecialidadID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:09.102 -05:00 [INF] Executed DbCommand (109ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEstadoCita` (
    `NEstadoCitaID` int(6) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEstadoCitaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:09.209 -05:00 [INF] Executed DbCommand (105ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEstadoUsuario` (
    `NEstadoUsuarioID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(20) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEstadoUsuarioID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:09.326 -05:00 [INF] Executed DbCommand (114ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TEstadoVerificacion` (
    `NEstadoVerificacion` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NEstadoVerificacion`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:09.444 -05:00 [INF] Executed DbCommand (115ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TGrupoSanguineo` (
    `NGrupoSanguineoID` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(10) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NGrupoSanguineoID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:09.578 -05:00 [INF] Executed DbCommand (132ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TRol` (
    `NRolID` int(32) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(20) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NRolID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:09.696 -05:00 [INF] Executed DbCommand (115ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TTipoIdentificacion` (
    `NTipoIdentificacion` int(12) NOT NULL AUTO_INCREMENT,
    `CNombre` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NTipoIdentificacion`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:09.814 -05:00 [INF] Executed DbCommand (115ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TUsuario` (
    `nUsuarioID` int(32) NOT NULL AUTO_INCREMENT,
    `NEstadoVerificacionFK` int(12) NOT NULL,
    `NEstadoUsuarioFK` int(12) NOT NULL,
    `NRolFK` int(12) NOT NULL,
    `CNombre` varchar(50) CHARACTER SET utf8mb4 NOT NULL,
    `CApellido` varchar(100) CHARACTER SET utf8mb4 NOT NULL,
    `CEmail` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `CPassword` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaRegistro` DateTime NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`nUsuarioID`),
    CONSTRAINT `FK_Usuario_EstadoUsuario` FOREIGN KEY (`NEstadoUsuarioFK`) REFERENCES `TEstadoUsuario` (`NEstadoUsuarioID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_Usuario_EstadoVerificacion` FOREIGN KEY (`NEstadoVerificacionFK`) REFERENCES `TEstadoVerificacion` (`NEstadoVerificacion`) ON DELETE RESTRICT,
    CONSTRAINT `FK_Usuario_Rol` FOREIGN KEY (`NRolFK`) REFERENCES `TRol` (`NRolID`) ON DELETE RESTRICT
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:09.939 -05:00 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TCodigoVerificacion` (
    `NCodigoVerificacionID` int(32) NOT NULL AUTO_INCREMENT,
    `NUsuarioFK` int(6) NOT NULL,
    `CCodigo` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `ETipoCodigo` varchar(25) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaExpiracion` datetime NOT NULL,
    `BUsado` tinyint(1) NOT NULL DEFAULT FALSE,
    `NIntentos` int(11) NOT NULL,
    `DFechaCreacion` datetime NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NCodigoVerificacionID`),
    CONSTRAINT `FK_CodigoVerificacion_Usuario` FOREIGN KEY (`NUsuarioFK`) REFERENCES `TUsuario` (`nUsuarioID`) ON DELETE RESTRICT
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:10.064 -05:00 [INF] Executed DbCommand (123ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TLogins` (
    `NLoginID` int(32) NOT NULL AUTO_INCREMENT,
    `DFechaLogin` DateTime NOT NULL,
    `NUsuarioFK` int(32) NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NLoginID`),
    CONSTRAINT `FK_Usuario_Logins` FOREIGN KEY (`NUsuarioFK`) REFERENCES `TUsuario` (`nUsuarioID`) ON DELETE RESTRICT
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:10.191 -05:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TPersona` (
    `NPersonaID` int(32) NOT NULL AUTO_INCREMENT,
    `NUsuarioFK` int(32) NOT NULL,
    `NTipoIdentificacionFK` int(32) NOT NULL,
    `CNroIdentificacion` varchar(20) CHARACTER SET utf8mb4 NOT NULL,
    `CNroConctacto` varchar(30) CHARACTER SET utf8mb4 NOT NULL,
    `CDireccion` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaNacimiento` DateTime NOT NULL,
    `ESexo` varchar(25) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NPersonaID`),
    CONSTRAINT `FK_Personas_TipoIdentificacion` FOREIGN KEY (`NTipoIdentificacionFK`) REFERENCES `TTipoIdentificacion` (`NTipoIdentificacion`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TPersona_TUsuario_NUsuarioFK` FOREIGN KEY (`NUsuarioFK`) REFERENCES `TUsuario` (`nUsuarioID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:10.316 -05:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TPaciente` (
    `NPacienteID` int(32) NOT NULL AUTO_INCREMENT,
    `NPersonaFK` int(32) NOT NULL,
    `NGrupoSanguineoFK` int(6) NOT NULL,
    `CAlergiasGenerales` varchar(2000) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NPacienteID`),
    CONSTRAINT `FK_Paciente_GrupoSanguineo` FOREIGN KEY (`NGrupoSanguineoFK`) REFERENCES `TGrupoSanguineo` (`NGrupoSanguineoID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TPaciente_TPersona_NPersonaFK` FOREIGN KEY (`NPersonaFK`) REFERENCES `TPersona` (`NPersonaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:10.436 -05:00 [INF] Executed DbCommand (118ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TProfesional` (
    `NProfesionalID` int(32) NOT NULL AUTO_INCREMENT,
    `NPersonaFK` int(32) NOT NULL,
    `NEspecialidadFK` int(12) NOT NULL,
    `NAreaFK` int(12) NOT NULL,
    `CRegistroProfesional` varchar(50) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaContratacion` DateTime NOT NULL,
    `ETipoProfesional` varchar(25) CHARACTER SET utf8mb4 NOT NULL,
    `CBiografia` varchar(2000) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NProfesionalID`),
    CONSTRAINT `FK_Profesional_Area` FOREIGN KEY (`NAreaFK`) REFERENCES `TArea` (`NAreaID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_Profesional_Especialidad` FOREIGN KEY (`NEspecialidadFK`) REFERENCES `TEspecialidad` (`NEspecialidadID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TProfesional_TPersona_NPersonaFK` FOREIGN KEY (`NPersonaFK`) REFERENCES `TPersona` (`NPersonaID`)
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:10.571 -05:00 [INF] Executed DbCommand (133ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `TCita` (
    `NCitaID` int(12) NOT NULL AUTO_INCREMENT,
    `NEstadoCitaFK` int(12) NOT NULL,
    `NProfesionalFK` int(12) NOT NULL,
    `NPacienteFK` int(12) NOT NULL,
    `NDiaSemanaFK` int(12) NOT NULL,
    `DFecha` datetime NOT NULL,
    `DHora` time NOT NULL,
    `DDuracion` time NOT NULL,
    `CObservacion` varchar(500) CHARACTER SET utf8mb4 NOT NULL,
    `DFechaRegistro` datetime NOT NULL,
    `ProfesionalNProfesionalID` int(32) NOT NULL,
    `PacienteNPacienteID` int(32) NOT NULL,
    `EstadoNEstadoCitaID` int(6) NOT NULL,
    CONSTRAINT `PRIMARY` PRIMARY KEY (`NCitaID`),
    CONSTRAINT `FK_Cita_DiaSemana` FOREIGN KEY (`NDiaSemanaFK`) REFERENCES `TDiaSemana` (`NDiaSemanaID`) ON DELETE RESTRICT,
    CONSTRAINT `FK_TCita_TEstadoCita_EstadoNEstadoCitaID` FOREIGN KEY (`EstadoNEstadoCitaID`) REFERENCES `TEstadoCita` (`NEstadoCitaID`) ON DELETE CASCADE,
    CONSTRAINT `FK_TCita_TPaciente_PacienteNPacienteID` FOREIGN KEY (`PacienteNPacienteID`) REFERENCES `TPaciente` (`NPacienteID`) ON DELETE CASCADE,
    CONSTRAINT `FK_TCita_TProfesional_ProfesionalNProfesionalID` FOREIGN KEY (`ProfesionalNProfesionalID`) REFERENCES `TProfesional` (`NProfesionalID`) ON DELETE CASCADE
) CHARACTER SET=utf8mb4;
2025-09-20 17:20:10.684 -05:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TDiaSemana` (`NDiaSemanaID`, `CNombre`)
VALUES (1, 'Lunes'),
(2, 'Martes'),
(3, 'Miércoles'),
(4, 'Jueves'),
(5, 'Viernes'),
(6, 'Sábado'),
(7, 'Domingo');
2025-09-20 17:20:10.796 -05:00 [INF] Executed DbCommand (110ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TEstadoUsuario` (`NEstadoUsuarioID`, `CNombre`)
VALUES (1, 'Activo'),
(2, 'Inactivo');
2025-09-20 17:20:10.911 -05:00 [INF] Executed DbCommand (113ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TEstadoVerificacion` (`NEstadoVerificacion`, `CNombre`)
VALUES (1, 'No Verificado'),
(2, 'Verificado');
2025-09-20 17:20:11.016 -05:00 [INF] Executed DbCommand (103ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TGrupoSanguineo` (`NGrupoSanguineoID`, `CNombre`)
VALUES (1, 'A+'),
(2, 'A-'),
(3, 'B+'),
(4, 'B-'),
(5, 'AB+'),
(6, 'AB-'),
(7, 'O+'),
(8, 'O-');
2025-09-20 17:20:11.133 -05:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TRol` (`NRolID`, `CNombre`)
VALUES (1, 'Administrador'),
(2, 'Paciente'),
(3, 'Medico');
2025-09-20 17:20:11.244 -05:00 [INF] Executed DbCommand (108ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TTipoIdentificacion` (`NTipoIdentificacion`, `CNombre`)
VALUES (1, 'Cédula de ciudadanía'),
(2, 'Tarjeta de identidad'),
(3, 'Registro civil de nacimiento'),
(4, 'Cédula de extranjería'),
(5, 'Pasaporte');
2025-09-20 17:20:11.367 -05:00 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre` ON `TArea` (`CNombre`);
2025-09-20 17:20:11.506 -05:00 [INF] Executed DbCommand (136ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_EstadoNEstadoCitaID` ON `TCita` (`EstadoNEstadoCitaID`);
2025-09-20 17:20:11.654 -05:00 [INF] Executed DbCommand (145ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_NDiaSemanaFK` ON `TCita` (`NDiaSemanaFK`);
2025-09-20 17:20:11.813 -05:00 [INF] Executed DbCommand (157ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_PacienteNPacienteID` ON `TCita` (`PacienteNPacienteID`);
2025-09-20 17:20:11.942 -05:00 [INF] Executed DbCommand (125ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCita_ProfesionalNProfesionalID` ON `TCita` (`ProfesionalNProfesionalID`);
2025-09-20 17:20:12.057 -05:00 [INF] Executed DbCommand (113ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CCodigo` ON `TCodigoVerificacion` (`CCodigo`);
2025-09-20 17:20:12.466 -05:00 [INF] Executed DbCommand (407ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TCodigoVerificacion_NUsuarioFK` ON `TCodigoVerificacion` (`NUsuarioFK`);
2025-09-20 17:20:12.607 -05:00 [INF] Executed DbCommand (137ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre1` ON `TDiaSemana` (`CNombre`);
2025-09-20 17:20:12.735 -05:00 [INF] Executed DbCommand (125ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre2` ON `TEspecialidad` (`CNombre`);
2025-09-20 17:20:12.864 -05:00 [INF] Executed DbCommand (125ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre3` ON `TEstadoCita` (`CNombre`);
2025-09-20 17:20:12.998 -05:00 [INF] Executed DbCommand (131ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre4` ON `TEstadoUsuario` (`CNombre`);
2025-09-20 17:20:13.142 -05:00 [INF] Executed DbCommand (141ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre5` ON `TEstadoVerificacion` (`CNombre`);
2025-09-20 17:20:13.264 -05:00 [INF] Executed DbCommand (119ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre6` ON `TGrupoSanguineo` (`CNombre`);
2025-09-20 17:20:13.374 -05:00 [INF] Executed DbCommand (106ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TLogins_NUsuarioFK` ON `TLogins` (`NUsuarioFK`);
2025-09-20 17:20:13.500 -05:00 [INF] Executed DbCommand (123ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TPaciente_NGrupoSanguineoFK` ON `TPaciente` (`NGrupoSanguineoFK`);
2025-09-20 17:20:13.627 -05:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_TPaciente_NPersonaFK` ON `TPaciente` (`NPersonaFK`);
2025-09-20 17:20:13.747 -05:00 [INF] Executed DbCommand (119ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNroIdentificacion` ON `TPersona` (`CNroIdentificacion`);
2025-09-20 17:20:13.884 -05:00 [INF] Executed DbCommand (133ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TPersona_NTipoIdentificacionFK` ON `TPersona` (`NTipoIdentificacionFK`);
2025-09-20 17:20:14.007 -05:00 [INF] Executed DbCommand (118ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_TPersona_NUsuarioFK` ON `TPersona` (`NUsuarioFK`);
2025-09-20 17:20:14.137 -05:00 [INF] Executed DbCommand (126ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CRegistroProfesional` ON `TProfesional` (`CRegistroProfesional`);
2025-09-20 17:20:14.263 -05:00 [INF] Executed DbCommand (123ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TProfesional_NAreaFK` ON `TProfesional` (`NAreaFK`);
2025-09-20 17:20:14.379 -05:00 [INF] Executed DbCommand (114ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TProfesional_NEspecialidadFK` ON `TProfesional` (`NEspecialidadFK`);
2025-09-20 17:20:14.499 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `IX_TProfesional_NPersonaFK` ON `TProfesional` (`NPersonaFK`);
2025-09-20 17:20:14.624 -05:00 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre7` ON `TRol` (`CNombre`);
2025-09-20 17:20:14.747 -05:00 [INF] Executed DbCommand (120ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CNombre8` ON `TTipoIdentificacion` (`CNombre`);
2025-09-20 17:20:14.895 -05:00 [INF] Executed DbCommand (144ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX `CEmail` ON `TUsuario` (`CEmail`);
2025-09-20 17:20:15.025 -05:00 [INF] Executed DbCommand (127ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TUsuario_NEstadoUsuarioFK` ON `TUsuario` (`NEstadoUsuarioFK`);
2025-09-20 17:20:15.150 -05:00 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TUsuario_NEstadoVerificacionFK` ON `TUsuario` (`NEstadoVerificacionFK`);
2025-09-20 17:20:15.271 -05:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_TUsuario_NRolFK` ON `TUsuario` (`NRolFK`);
2025-09-20 17:20:15.495 -05:00 [INF] User profile is available. Using 'C:\Users\ronal\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-20 17:20:15.566 -05:00 [INF] Now listening on: http://[::]:5000
2025-09-20 17:20:15.570 -05:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-20 17:20:15.571 -05:00 [INF] Hosting environment: Production
2025-09-20 17:20:15.572 -05:00 [INF] Content root path: C:\Users\ronal\Desktop\Archivos\Api_Mediconnet_Onion\api
2025-09-20 17:20:25.162 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/Usuario - application/json 139
2025-09-20 17:20:25.246 -05:00 [WRN] Failed to determine the https port for redirect.
2025-09-20 17:20:25.358 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:20:25 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:20:25.390 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/08/2025 8:25:26 p. m.', Current time (UTC): '20/09/2025 10:20:25 p. m.'.
2025-09-20 17:20:25.398 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:20:25.441 -05:00 [INF] Route matched with {action = "PostUsuario", controller = "Usuario"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostUsuario(Api_Mediconnet.Application.DTOs.TUsuarioCreateDTO) on controller Api_Mediconnet.Api.Controllers.UsuarioController (Api_Mediconnet.Api).
2025-09-20 17:20:26.610 -05:00 [INF] Executed DbCommand (239ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 255), @p2='?' (Size = 50), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TUsuario` (`CApellido`, `CEmail`, `CNombre`, `CPassword`, `DFechaRegistro`, `NEstadoUsuarioFK`, `NEstadoVerificacionFK`, `NRolFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `nUsuarioID`
FROM `TUsuario`
WHERE ROW_COUNT() = 1 AND `nUsuarioID` = LAST_INSERT_ID();
2025-09-20 17:20:26.753 -05:00 [INF] Usuario con ID 1 creado exitosamente.
2025-09-20 17:20:27.233 -05:00 [INF] Executed DbCommand (113ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t0`.`CNombre`
FROM `TUsuario` AS `t`
INNER JOIN `TRol` AS `t0` ON `t`.`NRolFK` = `t0`.`NRolID`
WHERE `t`.`nUsuarioID` = @__id_0
LIMIT 1
2025-09-20 17:20:27.254 -05:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-20 17:20:27.295 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api) in 1846.9006ms
2025-09-20 17:20:27.300 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:20:27.309 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/Usuario - 200 null application/json; charset=utf-8 2149.1149ms
2025-09-20 17:20:39.870 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - null 0
2025-09-20 17:20:39.878 -05:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '19/09/2025 4:59:10 p. m.', Current time (UTC): '20/09/2025 10:20:39 p. m.'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-20 17:20:39.881 -05:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '19/09/2025 4:59:10 p. m.', Current time (UTC): '20/09/2025 10:20:39 p. m.'.
2025-09-20 17:20:39.888 -05:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-20 17:20:39.897 -05:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-20 17:20:39.900 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 401 0 null 30.6013ms
2025-09-20 17:21:05.498 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - null 0
2025-09-20 17:21:05.515 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:21:05.523 -05:00 [INF] Route matched with {action = "PostEmailCode", controller = "EmailCode"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] PostEmailCode() on controller Api_Mediconnet.Api.Controllers.EmailCodeController (Api_Mediconnet.Api).
2025-09-20 17:21:05.929 -05:00 [INF] Executed DbCommand (107ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`nUsuarioID`, `t`.`CApellido`, `t`.`CEmail`, `t`.`CNombre`, `t`.`CPassword`, `t`.`DFechaRegistro`, `t`.`NEstadoUsuarioFK`, `t`.`NEstadoVerificacionFK`, `t`.`NRolFK`
FROM `TUsuario` AS `t`
WHERE `t`.`nUsuarioID` = @__p_0
LIMIT 1
2025-09-20 17:21:05.934 -05:00 [INF] Email del usuario con ID 1 recuperado correctamente.
2025-09-20 17:21:06.553 -05:00 [INF] Executed DbCommand (228ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 25), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TCodigoVerificacion` (`CCodigo`, `DFechaCreacion`, `DFechaExpiracion`, `ETipoCodigo`, `NIntentos`, `NUsuarioFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT `NCodigoVerificacionID`, `BUsado`
FROM `TCodigoVerificacion`
WHERE ROW_COUNT() = 1 AND `NCodigoVerificacionID` = LAST_INSERT_ID();
2025-09-20 17:21:06.670 -05:00 [INF] Código de Verificación creado correctamente con ID 1.
2025-09-20 17:21:09.800 -05:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-20 17:21:09.801 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api) in 4276.1371ms
2025-09-20 17:21:09.802 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:21:09.804 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 200 0 null 4305.8184ms
2025-09-20 17:21:26.891 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode/Verificar - application/json 29
2025-09-20 17:21:26.896 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostVerificarEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:21:26.904 -05:00 [INF] Route matched with {action = "PostVerificarEmailCode", controller = "EmailCode"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] PostVerificarEmailCode(Api_Mediconnet.Application.DTOs.VerificarCodigoRequestDTO) on controller Api_Mediconnet.Api.Controllers.EmailCodeController (Api_Mediconnet.Api).
2025-09-20 17:21:27.404 -05:00 [INF] Executed DbCommand (137ms) [Parameters=[@__usuarioId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`NCodigoVerificacionID`, `t`.`BUsado`, `t`.`CCodigo`, `t`.`DFechaCreacion`, `t`.`DFechaExpiracion`, `t`.`ETipoCodigo`, `t`.`NIntentos`, `t`.`NUsuarioFK`
FROM `TCodigoVerificacion` AS `t`
WHERE ((`t`.`NUsuarioFK` = @__usuarioId_0) AND (`t`.`ETipoCodigo` = 'Email')) AND NOT (`t`.`BUsado`)
ORDER BY `t`.`DFechaCreacion` DESC
LIMIT 1
2025-09-20 17:21:27.408 -05:00 [WRN] El código de verificación con ID 1 es incorrecto.
2025-09-20 17:21:27.865 -05:00 [INF] Executed DbCommand (216ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 25), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `TCodigoVerificacion` SET `BUsado` = @p0, `CCodigo` = @p1, `DFechaCreacion` = @p2, `DFechaExpiracion` = @p3, `ETipoCodigo` = @p4, `NIntentos` = @p5, `NUsuarioFK` = @p6
WHERE `NCodigoVerificacionID` = @p7;
SELECT ROW_COUNT();
2025-09-20 17:21:27.871 -05:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-20 17:21:27.875 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.EmailCodeController.PostVerificarEmailCode (Api_Mediconnet.Api) in 967.6362ms
2025-09-20 17:21:27.877 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostVerificarEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:21:27.879 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode/Verificar - 400 null application/json; charset=utf-8 988.6025ms
2025-09-20 17:23:12.516 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/Usuario - null null
2025-09-20 17:23:12.520 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:23:12.523 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/Usuario - 204 null null 6.7022ms
2025-09-20 17:23:12.527 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/Usuario - application/json 102
2025-09-20 17:23:12.531 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:23:12.532 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:23:12.534 -05:00 [INF] Route matched with {action = "PostUsuario", controller = "Usuario"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostUsuario(Api_Mediconnet.Application.DTOs.TUsuarioCreateDTO) on controller Api_Mediconnet.Api.Controllers.UsuarioController (Api_Mediconnet.Api).
2025-09-20 17:23:13.380 -05:00 [INF] Executed DbCommand (104ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 255), @p2='?' (Size = 50), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TUsuario` (`CApellido`, `CEmail`, `CNombre`, `CPassword`, `DFechaRegistro`, `NEstadoUsuarioFK`, `NEstadoVerificacionFK`, `NRolFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `nUsuarioID`
FROM `TUsuario`
WHERE ROW_COUNT() = 1 AND `nUsuarioID` = LAST_INSERT_ID();
2025-09-20 17:23:13.488 -05:00 [INF] Usuario con ID 2 creado exitosamente.
2025-09-20 17:23:13.814 -05:00 [INF] Executed DbCommand (100ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t0`.`CNombre`
FROM `TUsuario` AS `t`
INNER JOIN `TRol` AS `t0` ON `t`.`NRolFK` = `t0`.`NRolID`
WHERE `t`.`nUsuarioID` = @__id_0
LIMIT 1
2025-09-20 17:23:13.819 -05:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-20 17:23:13.821 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api) in 1285.0002ms
2025-09-20 17:23:13.824 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.UsuarioController.PostUsuario (Api_Mediconnet.Api)'
2025-09-20 17:23:13.826 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/Usuario - 200 null application/json; charset=utf-8 1299.2206ms
2025-09-20 17:23:13.832 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - null null
2025-09-20 17:23:13.835 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:23:13.837 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - 204 null null 5.4462ms
2025-09-20 17:23:13.840 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - application/json 2
2025-09-20 17:23:13.843 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:23:13.846 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:23:13.848 -05:00 [INF] Route matched with {action = "PostEmailCode", controller = "EmailCode"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] PostEmailCode() on controller Api_Mediconnet.Api.Controllers.EmailCodeController (Api_Mediconnet.Api).
2025-09-20 17:23:14.317 -05:00 [INF] Executed DbCommand (107ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`nUsuarioID`, `t`.`CApellido`, `t`.`CEmail`, `t`.`CNombre`, `t`.`CPassword`, `t`.`DFechaRegistro`, `t`.`NEstadoUsuarioFK`, `t`.`NEstadoVerificacionFK`, `t`.`NRolFK`
FROM `TUsuario` AS `t`
WHERE `t`.`nUsuarioID` = @__p_0
LIMIT 1
2025-09-20 17:23:14.320 -05:00 [INF] Email del usuario con ID 2 recuperado correctamente.
2025-09-20 17:23:14.985 -05:00 [INF] Executed DbCommand (222ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 25), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TCodigoVerificacion` (`CCodigo`, `DFechaCreacion`, `DFechaExpiracion`, `ETipoCodigo`, `NIntentos`, `NUsuarioFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT `NCodigoVerificacionID`, `BUsado`
FROM `TCodigoVerificacion`
WHERE ROW_COUNT() = 1 AND `NCodigoVerificacionID` = LAST_INSERT_ID();
2025-09-20 17:23:15.103 -05:00 [INF] Código de Verificación creado correctamente con ID 2.
2025-09-20 17:23:17.684 -05:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-20 17:23:17.686 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api) in 3835.2813ms
2025-09-20 17:23:17.689 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:23:17.690 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 200 0 null 3849.9873ms
2025-09-20 17:23:55.546 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - null null
2025-09-20 17:23:55.549 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:23:55.550 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - 204 null null 3.5734ms
2025-09-20 17:23:55.552 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - application/json 20
2025-09-20 17:23:55.556 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:23:55.558 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:23:55.559 -05:00 [INF] Route matched with {action = "PostEmailCode", controller = "EmailCode"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] PostEmailCode() on controller Api_Mediconnet.Api.Controllers.EmailCodeController (Api_Mediconnet.Api).
2025-09-20 17:23:56.131 -05:00 [INF] Executed DbCommand (112ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`nUsuarioID`, `t`.`CApellido`, `t`.`CEmail`, `t`.`CNombre`, `t`.`CPassword`, `t`.`DFechaRegistro`, `t`.`NEstadoUsuarioFK`, `t`.`NEstadoVerificacionFK`, `t`.`NRolFK`
FROM `TUsuario` AS `t`
WHERE `t`.`nUsuarioID` = @__p_0
LIMIT 1
2025-09-20 17:23:56.135 -05:00 [INF] Email del usuario con ID 2 recuperado correctamente.
2025-09-20 17:23:56.666 -05:00 [INF] Executed DbCommand (102ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 25), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TCodigoVerificacion` (`CCodigo`, `DFechaCreacion`, `DFechaExpiracion`, `ETipoCodigo`, `NIntentos`, `NUsuarioFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT `NCodigoVerificacionID`, `BUsado`
FROM `TCodigoVerificacion`
WHERE ROW_COUNT() = 1 AND `NCodigoVerificacionID` = LAST_INSERT_ID();
2025-09-20 17:23:56.778 -05:00 [INF] Código de Verificación creado correctamente con ID 3.
2025-09-20 17:23:58.752 -05:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-20 17:23:58.754 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api) in 3192.6309ms
2025-09-20 17:23:58.755 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:23:58.757 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 200 0 null 3204.9782ms
2025-09-20 17:34:49.628 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - null null
2025-09-20 17:34:49.631 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:34:49.632 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode - 204 null null 4.0912ms
2025-09-20 17:34:49.635 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode - application/json 18
2025-09-20 17:34:49.637 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:34:49.640 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:34:49.641 -05:00 [INF] Route matched with {action = "PostEmailCode", controller = "EmailCode"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] PostEmailCode() on controller Api_Mediconnet.Api.Controllers.EmailCodeController (Api_Mediconnet.Api).
2025-09-20 17:34:51.410 -05:00 [INF] Executed DbCommand (112ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`nUsuarioID`, `t`.`CApellido`, `t`.`CEmail`, `t`.`CNombre`, `t`.`CPassword`, `t`.`DFechaRegistro`, `t`.`NEstadoUsuarioFK`, `t`.`NEstadoVerificacionFK`, `t`.`NRolFK`
FROM `TUsuario` AS `t`
WHERE `t`.`nUsuarioID` = @__p_0
LIMIT 1
2025-09-20 17:34:51.415 -05:00 [INF] Email del usuario con ID 2 recuperado correctamente.
2025-09-20 17:34:52.086 -05:00 [INF] Executed DbCommand (225ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 25), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `TCodigoVerificacion` (`CCodigo`, `DFechaCreacion`, `DFechaExpiracion`, `ETipoCodigo`, `NIntentos`, `NUsuarioFK`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT `NCodigoVerificacionID`, `BUsado`
FROM `TCodigoVerificacion`
WHERE ROW_COUNT() = 1 AND `NCodigoVerificacionID` = LAST_INSERT_ID();
2025-09-20 17:34:52.189 -05:00 [INF] Código de Verificación creado correctamente con ID 4.
2025-09-20 17:34:54.563 -05:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-20 17:34:54.565 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api) in 4921.2866ms
2025-09-20 17:34:54.567 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:34:54.568 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode - 200 0 null 4933.4826ms
2025-09-20 17:37:31.924 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode/Verificar - null null
2025-09-20 17:37:31.926 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:37:31.927 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode/Verificar - 204 null null 3.1143ms
2025-09-20 17:37:31.930 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode/Verificar - application/json 20
2025-09-20 17:37:31.932 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:37:31.934 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostVerificarEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:37:31.935 -05:00 [INF] Route matched with {action = "PostVerificarEmailCode", controller = "EmailCode"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] PostVerificarEmailCode(Api_Mediconnet.Application.DTOs.VerificarCodigoRequestDTO) on controller Api_Mediconnet.Api.Controllers.EmailCodeController (Api_Mediconnet.Api).
2025-09-20 17:37:32.394 -05:00 [INF] Executed DbCommand (111ms) [Parameters=[@__usuarioId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`NCodigoVerificacionID`, `t`.`BUsado`, `t`.`CCodigo`, `t`.`DFechaCreacion`, `t`.`DFechaExpiracion`, `t`.`ETipoCodigo`, `t`.`NIntentos`, `t`.`NUsuarioFK`
FROM `TCodigoVerificacion` AS `t`
WHERE ((`t`.`NUsuarioFK` = @__usuarioId_0) AND (`t`.`ETipoCodigo` = 'Email')) AND NOT (`t`.`BUsado`)
ORDER BY `t`.`DFechaCreacion` DESC
LIMIT 1
2025-09-20 17:37:32.397 -05:00 [WRN] El código de verificación con ID 2 es incorrecto.
2025-09-20 17:37:32.866 -05:00 [INF] Executed DbCommand (240ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 25), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `TCodigoVerificacion` SET `BUsado` = @p0, `CCodigo` = @p1, `DFechaCreacion` = @p2, `DFechaExpiracion` = @p3, `ETipoCodigo` = @p4, `NIntentos` = @p5, `NUsuarioFK` = @p6
WHERE `NCodigoVerificacionID` = @p7;
SELECT ROW_COUNT();
2025-09-20 17:37:32.869 -05:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-20 17:37:32.871 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.EmailCodeController.PostVerificarEmailCode (Api_Mediconnet.Api) in 933.5058ms
2025-09-20 17:37:32.873 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostVerificarEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:37:32.876 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode/Verificar - 400 null application/json; charset=utf-8 945.6568ms
2025-09-20 17:37:57.697 -05:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode/Verificar - null null
2025-09-20 17:37:57.699 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:37:57.700 -05:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/Api/EmailCode/Verificar - 204 null null 3.7032ms
2025-09-20 17:37:57.703 -05:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Api/EmailCode/Verificar - application/json 19
2025-09-20 17:37:57.707 -05:00 [INF] CORS policy execution successful.
2025-09-20 17:37:57.708 -05:00 [INF] Executing endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostVerificarEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:37:57.709 -05:00 [INF] Route matched with {action = "PostVerificarEmailCode", controller = "EmailCode"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] PostVerificarEmailCode(Api_Mediconnet.Application.DTOs.VerificarCodigoRequestDTO) on controller Api_Mediconnet.Api.Controllers.EmailCodeController (Api_Mediconnet.Api).
2025-09-20 17:37:58.167 -05:00 [INF] Executed DbCommand (109ms) [Parameters=[@__usuarioId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`NCodigoVerificacionID`, `t`.`BUsado`, `t`.`CCodigo`, `t`.`DFechaCreacion`, `t`.`DFechaExpiracion`, `t`.`ETipoCodigo`, `t`.`NIntentos`, `t`.`NUsuarioFK`
FROM `TCodigoVerificacion` AS `t`
WHERE ((`t`.`NUsuarioFK` = @__usuarioId_0) AND (`t`.`ETipoCodigo` = 'Email')) AND NOT (`t`.`BUsado`)
ORDER BY `t`.`DFechaCreacion` DESC
LIMIT 1
2025-09-20 17:37:58.175 -05:00 [WRN] El código de verificación con ID 2 es correcto. Intento 1.
2025-09-20 17:37:58.623 -05:00 [INF] Executed DbCommand (220ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 25), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `TCodigoVerificacion` SET `BUsado` = @p0, `CCodigo` = @p1, `DFechaCreacion` = @p2, `DFechaExpiracion` = @p3, `ETipoCodigo` = @p4, `NIntentos` = @p5, `NUsuarioFK` = @p6
WHERE `NCodigoVerificacionID` = @p7;
SELECT ROW_COUNT();
2025-09-20 17:37:59.130 -05:00 [INF] Executed DbCommand (402ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`nUsuarioID`, `t`.`CApellido`, `t`.`CEmail`, `t`.`CNombre`, `t`.`CPassword`, `t`.`DFechaRegistro`, `t`.`NEstadoUsuarioFK`, `t`.`NEstadoVerificacionFK`, `t`.`NRolFK`
FROM `TUsuario` AS `t`
WHERE `t`.`nUsuarioID` = @__p_0
LIMIT 1
2025-09-20 17:37:59.573 -05:00 [INF] Executed DbCommand (211ms) [Parameters=[@p8='?' (DbType = Int32), @p0='?' (Size = 100), @p1='?' (Size = 255), @p2='?' (Size = 50), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `TUsuario` SET `CApellido` = @p0, `CEmail` = @p1, `CNombre` = @p2, `CPassword` = @p3, `DFechaRegistro` = @p4, `NEstadoUsuarioFK` = @p5, `NEstadoVerificacionFK` = @p6, `NRolFK` = @p7
WHERE `nUsuarioID` = @p8;
SELECT ROW_COUNT();
2025-09-20 17:37:59.578 -05:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-20 17:37:59.581 -05:00 [INF] Executed action Api_Mediconnet.Api.Controllers.EmailCodeController.PostVerificarEmailCode (Api_Mediconnet.Api) in 1869.7008ms
2025-09-20 17:37:59.583 -05:00 [INF] Executed endpoint 'Api_Mediconnet.Api.Controllers.EmailCodeController.PostVerificarEmailCode (Api_Mediconnet.Api)'
2025-09-20 17:37:59.586 -05:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Api/EmailCode/Verificar - 200 null application/json; charset=utf-8 1882.2763ms
